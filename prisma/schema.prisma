// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  ADMIN
  EMPLOYEE
  WORKER
}

model User {
  id            String   @id @default(cuid())
  name          String
  employeeCode  String?  @unique
  role          Role     @default(EMPLOYEE)
  email         String?
  pinHash       String?
  active        Boolean  @default(true)

  defaultLocationId String?
  defaultLocation   Location? @relation("UserDefaultLocation", fields: [defaultLocationId], references: [id])

  shifts       Shift[]

  createdAt    DateTime @default(now())
  // REMOVE this line if present:
  // updatedAt    DateTime @updatedAt
}

model Location {
  id           String   @id @default(cuid())
  name         String
  code         String   @unique
  lat          Float
  lng          Float
  radiusMeters Float
  active       Boolean  @default(true)

  shifts       Shift[]
  defaultUsers User[]   @relation("UserDefaultLocation")

  createdAt    DateTime @default(now())
  // REMOVE: updatedAt
}

model Shift {
  id          String   @id @default(cuid())

  userId      String
  locationId  String?

  clockIn     DateTime
  clockOut    DateTime?

  clockInLat   Float?
  clockInLng   Float?
  clockOutLat  Float?
  clockOutLng  Float?

  notes       String?

  user        User      @relation(fields: [userId], references: [id])
  location    Location? @relation(fields: [locationId], references: [id])

  createdAt   DateTime @default(now())
  // REMOVE: updatedAt
}